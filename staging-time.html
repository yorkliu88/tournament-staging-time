<html>
<head>
  <title>Tournament Staging Times</title>
  <style>
    .staging-container {
      display: flex;
      justify-content: flex-start;
      margin-bottom: 10px;
    }
    
    .location {
      font-weight: bold;
      width: 200px; /* Set a fixed width for the location column */
    }
    
    .time {
      margin-left: 10px;
    }
    
    .last-updated-container {
      display: flex;
      justify-content: flex-start;
      margin-top: 20px; /* Add some space above */
    }
  </style>
  <script>
    function loadStagingTimes() {

      var spreadsheetId = '1PHXNh74wemifZlv91l9hOZ-1-WTtrcp7gI8_-JR872c';  // Your Google Sheet ID
      var automallTime = 'Sheet1!B1';  // Specify the range (e.g., A1)
      var missionTime = 'Sheet1!B2';  // Specify the range (e.g., A1)
      var apiKey = 'AIzaSyAwq2XmrASVwh8Eq6D7LAgunSBAST6Gup4';          // Replace with your Google API Key

      // URLs to fetch staging times for AutoMall (A1) and Mission (B1)
      var urlAutoMall = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${automallTime}?key=${apiKey}`;
      var urlMission = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/Sheet1!B1?key=${apiKey}`;

      // Fetch staging time for AutoMall
      fetch(urlAutoMall)
        .then(response => response.json())
        .then(data => {
          document.getElementById('stagingTimeAutoMall').textContent = data.values[0][0];
        })
        .catch(error => {
          document.getElementById('stagingTimeAutoMall').textContent = 'Error loading data';
          console.error('Error fetching AutoMall data:', error);
        });

      // Fetch staging time for Mission
      fetch(urlMission)
        .then(response => response.json())
        .then(data => {
          document.getElementById('stagingTimeMission').textContent = data.values[0][0];
        })
        .catch(error => {
          document.getElementById('stagingTimeMission').textContent = 'Error loading data';
          console.error('Error fetching Mission data:', error);
        });

      // Fetch last modified time of the Google Sheet
      var urlModifiedTime = `https://www.googleapis.com/drive/v3/files/${spreadsheetId}?fields=modifiedTime&key=${apiKey}`;

      fetch(urlModifiedTime)
        .then(response => response.json())
        .then(data => {
          var lastModified = new Date(data.modifiedTime);
          document.getElementById('lastUpdatedTime').textContent = 'Last Updated: ' + lastModified.toLocaleString();
        })
        .catch(error => {
          document.getElementById('lastUpdatedTime').textContent = 'Error fetching last updated time';
          console.error('Error fetching last updated time:', error);
        });
    }

    // Automatically refresh data every 30 seconds
    setInterval(loadStagingTimes, 30000);  // 30,000 milliseconds = 30 seconds
  </script>
</head>
<body onload="loadStagingTimes()">
  <h1>Current Tournament Staging Times</h1>
  
  <div class="staging-container">
    <div class="location">AutoMall Location:</div>
    <div class="time" id="stagingTimeAutoMall">Loading...</div>
  </div>
  
  <div class="staging-container">
    <div class="location">Mission Location:</div>
    <div class="time" id="stagingTimeMission">Loading...</div>
  </div>

  <div class="last-updated-container">
    <div class="location">Last Updated:</div>
    <div class="time" id="lastUpdatedTime">Loading...</div>
  </div>
</body>
</html>

